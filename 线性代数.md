# 线性代数

## 1. 线性代数中的线性方程组

### 1.1 线性方程组系统（systems of linear equations）

线性方程（linear equation）可以被写作以下格式：
$$
a_1x_1 + a_2x_2 + \cdots + a_nx_n = b \tag{1}
$$
一个**线性方程组系统**是由一个或多个包含相同变量（$x_1, \cdots, x_n$）的**线性方程**组成的**集合**。

#### 线性系统（linear systems）的一般性事实：

一个线性方程组系统，有

1. 无解，或
2. 有且仅有一个解，或
3. 无穷多个解

当一个线性方程组系统有且仅有一个解或有无穷多个解时，称这个系统是一致性的（**consistent**）；当这个系统没有解时，称这个系统是不一致的（**inconsistent**）。

#### 矩阵符号法

有如下系统
$$
\begin{split}
&x_1 &- &2x_2 &+ &x_3  &= 0 \\
      &&&2x_2 &- &8x_3 &= 8 \\ 
&5x_1    &&   &- &5x_3 &= 10
\end{split}\tag{2}
$$
每个变量的系数按列对齐，矩阵如下
$$
\begin{bmatrix}
1 &-2 &1 \\
0 &2  &-8 \\
5 &0  &-5
\end{bmatrix}\tag{3}
$$
称为**系数矩阵**（**coefficient matrix**），而
$$
\left[\begin{array}{ccc|c}
1    &-2    &1    &0 \\
0    &2     &-8   &8 \\
5    &0     &-5   &10
\end{array}\right]\tag{4}
$$
称为**增广矩阵**（**augmented matrix**）

矩阵的大小（size）告诉我们矩阵有多少行和多少列，如上面的矩阵（3）有3行4列所以称为$3 \times 4$矩阵。若 $m$ 和 $n$ 都是正整数，则 $m \times n$ 矩阵表示一个有 $m$ 行 $n$ 列的矩形数组。

#### 求解线性系统

行初等变换（elementary row operations）

1. （替换）用一行加上一个倍数的另一行替换原来的行。
2. （交换）交换两行。
3. （缩放）将一行中的所有项乘以一个非零常数。

一个矩阵经过一系列行初等变换后成为另一个矩阵，则称这两个矩阵是行等价的（**row equivalent**）。

如果两个线性系统的增广矩阵是行等价的，则这两个矩阵有相同的解集（solution set）。

#### 存在性（Existence）与唯一性（Uniqueness）问题

关于线性系统的两个基本问题：

1. 系统是否是一致性的（是否**存在**至少一个解？）。
2. 如果解存在，那么是否只有一个解。（是否**唯一**解）。

### 1.2 行简化和梯形矩阵（row reduction and echelon forms）

非零行或列（nonzero row or column）：矩阵的行或列包含至少有一个非零元素。

行首项（a **leading entry** of a row）：非零行的最左边的非零元素

如果一个矩形矩阵具有以下三个性质，则它就是**阶梯形矩阵（echelon form）**或**行阶梯形矩阵（row echelon form）**：

1. 所有非零行在任意全零行的上方。
2. 每个行首项都位于其上方行的首项的右侧的一列中。
3. 行首项的下方的项全部为零。

如果阶梯形矩阵满足以下附加条件，则它为**简化阶梯形矩阵**（**reduced echelon form**）或行简化行阶梯形矩阵（reduced row echelon form）：

4. 每一个非零行的行首项都为1。
5. 行首项为1的列中仅有一个非零项。

**定理1：简化阶梯型矩阵的唯一性。**

**每一个矩阵行等价有且仅有一个简化阶梯型矩阵。**

若矩阵 $A$ 行等价于 矩阵 $U$ ，我们称 $U$ 为矩阵 $A$ 的一个阶梯形矩阵；如果矩阵 $U$ 是简化阶梯形矩阵，我们称 $U$ 为矩阵 $A$ 的简化阶梯形矩阵。

#### 主元位置（pivot positions）

矩阵 $A$ 的简化阶梯形矩阵中的首项1的位置称为矩阵 $A$ 的主元位置。

矩阵 $A$ 中包含主元位置的列称为主元列（pivot column）。

主元位置上的值称为**主元**（**pivot**）。

#### 行消除算法

$$
\begin{bmatrix}
0   &3   &-6   &6   &4   &-5 \\
3   &-7  &8    &-5  &8   &9 \\
3   &-9  &12   &-9  &6   &15 \\
\end{bmatrix}
$$



1. **从最左非零列开始。这一列为主元列，主元位置在该列的顶部。**

$$
\begin{bmatrix}
0   &3   &-6   &6   &4   &-5 \\
3   &-7  &8    &-5  &8   &9 \\
3   &-9  &12   &-9  &6   &15 \\
\end{bmatrix} 
\\
\uparrow      \quad\quad\quad\quad\quad\quad\quad\quad\quad\quad\ \\
主元列 \quad\quad\quad\quad\quad\quad\quad\quad\quad\quad\
$$

2. **选择主元列中的非零项作为主元。如果必要，交换行将此项移动到主元位置。**


$$
主元 \quad\quad\quad\quad\quad\quad\quad \\
   \swarrow \quad\quad\quad\quad\quad\quad\quad\quad\ \\
   \begin{bmatrix}
   3   &-9  &12   &-9  &6   &15 \\
   3   &-7  &8    &-5  &8   &9 \\
   0   &3   &-6   &6   &4   &-5 \\
   \end{bmatrix} \\
   \quad\\
   交换第1、3行。
$$

3. **使用行替换操作将主元以下的位置都置为0。**
   $$
   主元 \quad\quad\quad\quad\quad\quad\quad \\
   \swarrow \quad\quad\quad\quad\quad\quad\quad\quad\ \\
   \begin{bmatrix}
   3   &-9  &12   &-9  &6   &15 \\
   0   &2   &-4   &4   &2   &-6 \\
   0   &3   &-6   &6   &4   &-5 \\
   \end{bmatrix} \\
   \quad \\
   在第1列中有两个3，那么将-1乘以第1行加到第2行就很容易了。
   $$

4. **覆盖(或忽略)包含主元位置的行，并覆盖其之上的所有行(如果有的话)。对剩下的子矩阵应用步骤1-3。重复此过程，直到不再有非零行需要修改为止。**
   $$
   \begin{bmatrix}
   3   &-9  &12   &-9  &6   &15 \\
   0   &2   &-4   &4   &2   &-6 \\
   0   &3   &-6   &6   &4   &-5 \\
   \end{bmatrix} \\
   \uparrow      \quad\quad\quad\quad\quad\quad\quad \\
   新主元列(主元为2)        \quad\quad\quad\quad\quad\quad\quad
   $$

   对新主元列重复步骤1到3

   $$
   \begin{bmatrix}
   3   &-9  &12   &-9  &6   &15 \\
   0   &2   &-4   &4   &2   &-6 \\
   0   &0   &0   &0   &1   &4 \\
   \end{bmatrix} \\
   $$

   剩下的子矩阵已不需再重复步骤1到3了，我们已经得到了一个阶梯形矩阵，如果我们想要获得简化阶梯形矩阵，那么我们需要再往下执行一个步骤。

5. **从最右边的主元开始，向上并向左工作，在每个主元之上创建0。如果主元不为1，通过缩放操作使其为1。**

   从第3行最右边的主元，通过加上合适倍数的第3行到第1、2行，使得它们为零。
   $$
   \begin{bmatrix}
   3   &-9  &12   &-9  &0   &-9 \\
   0   &2   &-4   &4   &0   &-14 \\
   0   &0   &0   &0   &1   &4 \\
   \end{bmatrix} \\
   \quad \\
   第1行=第1行 + (-6) \times 第3行 \\
   第2行=第2行 + (-2) \times 第3行 \\
   $$
   下一个主元在第2行。先通过除以主元来缩放这一行。
   $$
   \begin{bmatrix}
   3   &-9  &12   &-9  &0   &-9 \\
   0   &1   &-2   &2   &0   &-7 \\
   0   &0   &0   &0   &1   &4 \\
   \end{bmatrix} \\
   \quad \\
   第2行=(\frac{1}2) \times 第2行
   $$
   第1行加上9倍的第2行。
   $$
   \begin{bmatrix}
   3   &0  &-6   &9  &0   &-72 \\
   0   &1   &-2   &2   &0   &-7 \\
   0   &0   &0   &0   &1   &4 \\
   \end{bmatrix} \\
   \quad \\
   第1行 = 第1行 + 9 \times 第2行
   $$
   最后，缩放第1行。
   $$
   \begin{bmatrix}
   1   &0  &-2   &3  &0   &-24 \\
   0   &1   &-2   &2   &0   &-7 \\
   0   &0   &0   &0   &1   &4 \\
   \end{bmatrix} \\
   \quad \\
   第1行=(\frac{1}{3}) \times 第1行
   $$
   这就是原始矩阵的简化阶梯形矩阵。

   步骤1-4称为行消除算法的**前置阶段**（**forward phase**）。步骤5，即产生唯一简化阶梯形矩阵的步骤，称为**后置阶段**（**backward phase**）。

   注意：步骤2中，一个计算机程序通常选择列中绝对值最大的项作为主元。这种策略称为**部分主元消元**（**partial pivoting**），因为它能减少计算中的舍入错误（roundoff errors）。

#### 求解线性系统

假设，一个线性系统中的增广矩阵已转换成如下等价的简化阶梯形矩阵：
$$
\left[\begin{matrix}
1   &   0   &   -5   &   1 \\
0   &   1   &    1   &   4 \\
0   &   0   &    0   &   0 \\
\end{matrix}\right]
$$
因为这个增广矩阵有4列，故总共有3个变量。所以相关联的方程组如下：
$$
\begin{split}
x_1 &  &- &5x_3 &= &1\\
&     x_2 &+ &x_3 &= &4 \\
&&&0 &= &0 \\
\end{split}\tag{5}
$$
主元列中的变量$x_1$和$x_2$称为**基本变量**（**basic variable**），剩下的变量称为**自由变量**（**free variable**）。

当线性系统是一致性的，如方程组$(5)$，它的解集是可以通过自由变量表示基本变量的方式求解方程组后被精确描述的。
$$
\begin{cases}
x_1 = 1 + 5x_3 \\
x_2 = 4 - x_3  \\
x_3是任意的  (x_3 \; is \; free)
\end{cases}\tag{6}
$$

#### 回代（back substitution）

考虑如下系统，增广矩阵已经转化为阶梯形矩阵，但还没转化为简化阶梯形矩阵：
$$
\begin{split}
x_1 - 7x_2 + 2x_3 - 5x_4 &+ 8x_5 &= 10 \\
      x_2  - 3x_3 + 3x_4 &+ x_5  &= -5 \\
                    x_4  &- x_5  &= 4 \\
\end{split}
$$


计算机程序求解线性系统是通过回代的方式，而不是计算简化阶梯形矩阵。

程序会先用$x_5$表示$x_4$的方式解出方程3（$x_4 = x_5 + 4$），再回代如方程2解出$x_2$，最后再将$x_2$和$x_4$代入方程1中解出$x_1$。

使用行消除算法有助于我们在手工计算时减少出错。

注意：通常，行消除前置阶段比后置阶段耗费更多的时间。求解一个系统的算法通常是用浮点计算（flops，floating point operations）测量的。一次浮点计算指两个实浮点数的算术运算（+，-，*，/）。如一个$n \times (n +1)$矩阵，消除为阶梯形矩阵需要$\frac{2n^3}{3} + \frac{n^2}{2} -\frac{7n}{6}$ 次浮点计算（当n非常大时，接近$\frac{2n^3}{3}$）。相比之下，进一步消除到简化阶梯形矩阵最多需要$n^2$次浮点运算。

#### 存在性与唯一性问题

**定理2：一个线性系统当且仅当它的增广矩阵的最右列不是主元列时，我们称这个系统是一致性的。**换句话说，它的一个阶梯形矩阵没有任何一行的格式如下
$$
\left[\begin{matrix}
0 & \cdots & 0 & b
\end{matrix}\right] 
\quad b不为0
$$
**如果一个线性系统是一致性的，则它的结果集要么是没有任何自由变量的唯一结果，要么有至少一个自由变量的无穷多个结果。**